/*!
 * @zevanoo/baileys-ez v1.0.0
 * Copyright (c) 2025 Zevano
 * Licensed under MIT
 */

import{fileTypeFromBuffer as n}from"file-type";import"moment-timezone";import"util";import c from"axios";import l from"path";import p from"mime-types";class u{constructor(){}sleep(e){return new Promise(i=>setTimeout(i,e))}async getFile(e,i){let s=null,t=await this.fetchBuffer(e);return t!=null&&t.data&&i&&(s=l.join(process.cwd(),"temp",Date.now()+"."+t.ext),fs.promises.writeFile(s,t==null?void 0:t.data)),{filename:t!=null&&t.name?t.name:s,...t}}async fetchBuffer(e){var i,s,t;try{if(/^https?:\/\//i.test(e)){const{data:a,headers:o}=await c.get(e,{responseType:"arraybuffer"}),r=Buffer.from(a,"binary"),m=((s=(i=o["content-disposition"])==null?void 0:i.match(/filename="?(.+?)"?$/))==null?void 0:s[1])||"",f=o["content-type"]||((t=await n(r))==null?void 0:t.mime);return{data:r,size:r.length,name:m,mime:f,ext:p.extension(f)}}else if(/^data:.*?\/.*?;base64,/i.test(e)){const a=Buffer.from(e.split`,`[1],"base64");return{data:a,size:a.length,...await n(a)||{mime:"application/octet-stream",ext:".bin"}}}else if(fs.existsSync(e)&&fs.statSync(e).isFile()){const a=fs.readFileSync(e);return{data:a,size:a.length,...await n(a)||{mime:"application/octet-stream",ext:".bin"}}}else{if(Buffer.isBuffer(e))return{data:e,size:e.length,...await n(e)||{mime:"application/octet-stream",ext:".bin"}};console.error("Invalid input type",e)}}catch(a){console.error(a,e)}}parseArgs(e){const i=e.match(/--\w+(?:[= ](?:[^\s"']+|".+?"|'.+?'))?/g)||[],s={},t=/--(\w+)(?:[= ]((?:[^\s"']+)|(?:"[^"]*")|(?:'[^']*')))?/;return i.forEach(a=>{const o=a.match(t);if(o){let r=o[2];r===void 0?s[o[1]]=!0:/^["']/.test(r)?s[o[1]]=r.slice(1,-1):s[o[1]]=r}}),s}}const S=new u;export{S as Func};

/*!
 * @zevanoo/baileys-ez v1.0.0
 * Copyright (c) 2025 Zevano
 * Licensed under MIT
 */

import{fileTypeFromBuffer as f}from"file-type";import u from"axios";import c from"path";import h from"mime-types";import o from"fs";import{Buffer as l}from"buffer";class w{constructor(){}sleep(e){return new Promise(s=>setTimeout(s,e))}async getFile(e,s){let i=null;const a=await this.fetchBuffer(e);if(a){if(a.data&&s){const t=c.join(process.cwd(),"temp");o.existsSync(t)||o.mkdirSync(t,{recursive:!0}),i=c.join(t,Date.now()+"."+a.ext),await o.promises.writeFile(i,a.data)}return{filename:a.name||i,...a}}}async fetchBuffer(e){var s,i,a;try{if(typeof e=="string"&&/^https?:\/\//i.test(e)){const{data:t,headers:n}=await u.get(e,{responseType:"arraybuffer"}),r=l.from(t,"binary"),m=((i=(s=n["content-disposition"])==null?void 0:s.match(/filename="?(.+?)"?$/))==null?void 0:i[1])||"",p=n["content-type"]||((a=await f(r))==null?void 0:a.mime),d=h.extension(p||"");return{data:r,size:r.length,name:m,mime:p,ext:d}}else if(typeof e=="string"&&/^data:.*?\/.*?;base64,/i.test(e)){const t=l.from(e.split(",")[1],"base64"),n=await f(t);return{data:t,size:t.length,name:"",mime:(n==null?void 0:n.mime)||"application/octet-stream",ext:(n==null?void 0:n.ext)||"bin"}}else if(typeof e=="string"&&o.existsSync(e)&&o.statSync(e).isFile()){const t=await o.promises.readFile(e),n=await f(t);return{data:t,size:t.length,name:c.basename(e),mime:(n==null?void 0:n.mime)||"application/octet-stream",ext:(n==null?void 0:n.ext)||"bin"}}else if(l.isBuffer(e)){const t=await f(e);return{data:e,size:e.length,name:"",mime:(t==null?void 0:t.mime)||"application/octet-stream",ext:(t==null?void 0:t.ext)||"bin"}}else{console.error("Invalid input type",e);return}}catch(t){console.error(t,e);return}}parseArgs(e){const s=e.match(/--\w+(?:[= ](?:[^\s"']+|".+?"|'.+?'))?/g)||[],i={},a=/--(\w+)(?:[= ]((?:[^\s"']+)|(?:"[^"]*")|(?:'[^']*')))?/;return s.forEach(t=>{const n=t.match(a);if(n){const r=n[1];let m=n[2];m===void 0?i[r]=!0:/^["']/.test(m)?i[r]=m.slice(1,-1):i[r]=m}}),i}}const S=new w;export{S as Func};
